const { JSDOM } = require('jsdom');
const cheerio = require('cheerio');
const { createQueryString }  = require('./createQueryString');

// テストケース
const testCases = [
  {
    name: "単純な分数",
    mml: `<math mathsize="150%" id="testmml"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mfrac class="structure-node"><mrow class="integration-node"><mi class="character-node">x</mi><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+5.449951171875px" depth="+4.2500457763671875px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">a</mi><mi class="character-node">-</mi><mi class="character-node">z</mi><mi class="character-node">A</mi><mi class="character-node">-</mi><mi class="character-node">Z</mi></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.816650390625px" depth="+2.183349609375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+2.95001220703125px" depth="+1.7499847412109375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">0</mi></mrow></mpadded></mrow></mpadded></menclose></mrow>
  <mrow class="integration-node"><mi class="character-node">.</mi>
  <mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow>
</mfrac><mi class="character-node">+</mi><mfrac class="structure-node"><mrow class="integration-node"><mi class="character-node">y</mi><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+5.449951171875px" depth="+4.2500457763671875px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">a</mi><mi class="character-node">-</mi><mi class="character-node">z</mi><mi class="character-node">A</mi><mi class="character-node">-</mi><mi class="character-node">Z</mi></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.816650390625px" depth="+2.183349609375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+2.95001220703125px" depth="+1.7499847412109375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">0</mi></mrow></mpadded></mrow></mpadded></menclose></mrow>
  <mrow class="integration-node"><mi class="character-node">.</mi>
  <mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow></mfrac><mi class="character-node">=</mi><mi class="character-node">1</mi></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mfrac class="structure-node"><mrow class="integration-node"><mi class="character-node">y</mi><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+5.449951171875px" depth="+4.2500457763671875px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node highlight"><mi class="character-node">a</mi><mi class="character-node">-</mi><mi class="character-node">z</mi><mi class="character-node">A</mi><mi class="character-node">-</mi><mi class="character-node">Z</mi></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.816650390625px" depth="+2.183349609375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+2.95001220703125px" depth="+1.7499847412109375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">0</mi></mrow></mpadded></mrow></mpadded></menclose></mrow>
  <mrow class="integration-node"><mi class="character-node">.</mi>
  <mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow>
</mfrac><mi class="character-node">+</mi><mfrac class="structure-node"><mrow class="integration-node"><mi class="character-node">x</mi><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+5.449951171875px" depth="+4.2500457763671875px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">a</mi><mi class="character-node">-</mi><mi class="character-node">z</mi><mi class="character-node">A</mi><mi class="character-node">-</mi><mi class="character-node">Z</mi></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.816650390625px" depth="+2.183349609375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+2.95001220703125px" depth="+1.7499847412109375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">0</mi></mrow></mpadded></mrow></mpadded></menclose></mrow>
  <mrow class="integration-node"><mi class="character-node">.</mi>
  <mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow></mfrac><mi class="character-node">=</mi><mi class="character-node">1</mi></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></math>
`,
    expected: '\\frac{a}{b}'
  },
  {
    name: "test",
    mml: `<math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac class="structure-node"><mi>a</mi><mi>bc</mi></mfrac></math>`,    expected: '\\sup{x}{2}'
  },
  {
    name: "複数子要素（エラーになるはず）",
    mml: `<math><foo><bar>1</bar><baz>2</baz></foo></math>`,
    expectError: true
  },
  {
    name: "character-nodeのみ",
    mml: `<math><mi class="character-node">x</mi></math>`,
    expected: 'x'
  }
];

// MathML文字列をDOMノードに変換　JSOM　そのほか
/*function parseMathML(mml) {
  const dom = new JSDOM(mml, { contentType: "text/xml" });
  return dom.window.document.documentElement;
}*/
// MathML文字列をDOMノードに変換 cheerio Query
function parseMathML(mml) {
  const $ = cheerio.load(mml, { xmlMode: true });
  return $('math')[0];
}

for (const { name, mml, expected, expectError } of testCases) {
  try {
    const dom = parseMathML(mml);
    const result = createQueryString(dom);
    if (expectError) {
      console.error(`【${name}】→ 失敗（エラーが出るべきなのに出なかった）`);
    } else {
      console.log(`【${name}】`);
      //console.log(`  期待値: ${expected}`);
      console.log(`  正規化: ${result}\n`);
      /*if (result === expected) {
        console.log('  → OK\n');
      } else {
        console.error('  → NG!!\n');
      }*/
    }
  } catch (e) {
    if (expectError) {
      console.log(`【${name}】→ OK（エラー発生: ${e.message}）`);
    } else {
      console.error(`【${name}】で予期しないエラー:`, e);
    }
  }
}