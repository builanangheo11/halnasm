const { JSDOM } = require('jsdom');
//const cheerio = require('cheerio');
const { normalizePmmlTree } = require('./normalize');
const { createMathTreeString } = require('./createMathTreeString');
const { createQueryString } = require('./createQueryString');

const testCases = [
  {
    name: '楕円の標準型式',
    input: `<math mathsize="150%" id="testmml"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mfrac class="structure-node"><mrow class="integration-node"><mi class="character-node">x</mi><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+5.449951171875px" depth="+4.2500457763671875px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">a</mi><mi class="character-node">-</mi><mi class="character-node">z</mi><mi class="character-node">A</mi><mi class="character-node">-</mi><mi class="character-node">Z</mi></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.816650390625px" depth="+2.183349609375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+2.95001220703125px" depth="+1.7499847412109375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">0</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow></mfrac><mi class="character-node">+</mi><mfrac class="structure-node"><mrow class="integration-node"><mi class="character-node">y</mi><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+5.449951171875px" depth="+4.2500457763671875px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">a</mi><mi class="character-node">-</mi><mi class="character-node">z</mi><mi class="character-node">A</mi><mi class="character-node">-</mi><mi class="character-node">Z</mi></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.816650390625px" depth="+2.183349609375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+2.95001220703125px" depth="+1.7499847412109375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">0</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow></mfrac><mi class="character-node">=</mi><mi class="character-node">1</mi></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mfrac class="structure-node"><mrow class="integration-node"><mi class="character-node">y</mi><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+5.449951171875px" depth="+4.2500457763671875px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node highlight"><mi class="character-node">a</mi><mi class="character-node">-</mi><mi class="character-node">z</mi><mi class="character-node">A</mi><mi class="character-node">-</mi><mi class="character-node">Z</mi></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.816650390625px" depth="+2.183349609375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+2.95001220703125px" depth="+1.7499847412109375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">0</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow></mfrac><mi class="character-node">+</mi><mfrac class="structure-node"><mrow class="integration-node"><mi class="character-node">x</mi><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+5.449951171875px" depth="+4.2500457763671875px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">a</mi><mi class="character-node">-</mi><mi class="character-node">z</mi><mi class="character-node">A</mi><mi class="character-node">-</mi><mi class="character-node">Z</mi></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.816650390625px" depth="+2.183349609375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression boolean-or"><menclose notation="verticalstrike" class=""><mpadded class="style-enclosing-regular-expression style-boolean-or"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+2.95001220703125px" depth="+1.7499847412109375px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">0</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mrow></mpadded></mrow><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+1.5px" depth="+1.5px"><mrow class="integration-node"><mrow class="regular-expression enclosing-regular-expression character-class"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-character-class"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">1</mi><mi class="character-node">-</mi><mi class="character-node">9</mi></mrow></mpadded></mrow></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow><mrow class="regular-expression enclosing-regular-expression zero-or-one"><menclose notation="verticalstrike"><mpadded class="style-enclosing-regular-expression style-zero-or-one"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mi class="character-node">.</mi><mrow class="regular-expression enclosing-regular-expression more"><menclose notation="verticalstrike"><mpadded width="+0.375em" class="style-more-right-lines"><mpadded class="style-enclosing-regular-expression style-more"><mrow class="style-enclosing-regular-expression-content"><mpadded lspace="0.09375em" width="+0.1875em" height="+0.09375em" depth="+0.09375em"><mrow class="integration-node"><mpadded lspace="-0.02em" width="-0.04em" voffset="-0.1em" class="character-node wildcard regular-expression"><mi><svg width="0.8em" height="0.8em"><circle cx="0.4em" cy="0.4em" r="0.3em" stroke="black" fill="none"></circle><line x1="0.4em" y1="0.1em" x2="0.1em" y2="0.4em" stroke="black"></line><line x1="0.6121320343559642em" y1="0.18786796564403577em" x2="0.18786796564403577em" y2="0.6121320343559642em" stroke="black"></line><line x1="0.7em" y1="0.4em" x2="0.4em" y2="0.7em" stroke="black"></line></svg></mi></mpadded></mrow></mpadded></mrow></mpadded></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></mpadded></mrow></mpadded></menclose></mrow><msup class="structure-node"><mrow></mrow><mrow class="integration-node"><mi class="character-node">2</mi></mrow></msup></mrow></mfrac><mi class="character-node">=</mi><mi class="character-node">1</mi></mrow></mpadded></mrow></mpadded></menclose></mrow></mrow></math>
`,
    expected: `<math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="normal">x</mi><mi mathvariant="normal">y</mi></mrow></math>`
  },
  {
    name: '放物円の標準型式',
    input: `
      <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mrow>
          <mi>a</mi>
        </mrow>
      </math>
    `,
    expected: `<math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>a</mi></mrow></math>`
  },
  {
    name: '円形の標準型式',
    input: `
      <math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>a</mi><mi>bac</mi></mfrac>z</math>
    `,
    expected: `<math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mfrac><mrow><mi>a</mi></mrow><mrow><mi mathvariant="normal">b</mi><mi mathvariant="normal">c</mi></mrow></mfrac></mrow></math>`
  }
];
/*function parseMathML(mml) {
  const $ = cheerio.load(mml, { xmlMode: true });
  return $('math')[0];
}*/
testCases.forEach(({ name, input, expected }) => {
  const dom = new JSDOM(input, { contentType: "text/xml" });
  global.window = dom.window;
  global.document = dom.window.document;
  // prototypeMethodsが必要な場合はここでrequire
  // require('./prototypeMethods')(dom.window);
  const $ = require('jquery')(window);
  global.$ = $;
  require('./prototypeMethods')(dom.window);
  //const doma = parseMathML(input);

  const math = document.querySelector('math');
  const normalized = normalizePmmlTree(math);
  const serializer = new window.XMLSerializer();
  const result = serializer.serializeToString(normalized);
  //console.log('normalized:', result);

  
//createMathTreeStringを使用して正規化されたMathMLを生成
  const createMat = createMathTreeString(normalized);

  const resulta = createQueryString(result);
  //const createMat = createMathTreeString(normalized);

  //console.log(createMat);
  //const creatquery = createQueryString(result);
  console.log(`\n【${name}】`);
  //console.log('PmmlTree:', result);
  console.log('creatMat:', createMat);
  console.log('\ncreatQuery:', resulta);

  if (result === expected) {
    console.log('テスト成功\n');
  } else {
    console.log('テスト失敗\n');
  }
});